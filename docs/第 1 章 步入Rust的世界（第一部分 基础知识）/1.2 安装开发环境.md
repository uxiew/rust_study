# 1.2 å®‰è£…å¼€å‘ç¯å¢ƒ

Rust ç¼–è¯‘å™¨çš„ä¸‹è½½å’Œå®‰è£…æ–¹æ³•åœ¨å®˜ç½‘ä¸Šæœ‰æ–‡æ¡£è¯´æ˜ï¼Œç‚¹å‡»å®˜ç½‘ä¸Šçš„ Install é“¾æ¥å¯ä»¥æŸ¥çœ‹ã€‚Rust å®˜æ–¹å·²ç»æä¾›äº†é¢„ç¼–è¯‘å¥½çš„ç¼–è¯‘å™¨ä¾›æˆ‘ä»¬ä¸‹è½½ï¼Œæ”¯æŒ Windows å¹³å°ã€Linux å¹³å°ä»¥åŠ Mac å¹³å°ã€‚ä½†æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä¸å•ç‹¬ä¸‹è½½ Rust çš„ç¼–è¯‘å™¨ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå« [rustup](https://rustup.rs) çš„å·¥å…·å®‰è£… Rust ç›¸å…³çš„ä¸€æ•´å¥—å·¥å…·é“¾ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨ã€æ ‡å‡†åº“ã€cargo ç­‰ã€‚ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è½»æ˜“åœ°æ›´æ–°ç‰ˆæœ¬ã€åˆ‡æ¢æ¸ é“ã€å¤šå·¥å…·é“¾ç®¡ç†ç­‰ã€‚

åœ¨å®˜ç½‘ä¸Šä¸‹è½½ rustup-init ç¨‹åºï¼Œæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‰§è¡Œè¿™ä¸ªç¨‹åºï¼ŒæŒ‰ç…§æç¤ºé€‰æ‹©åˆé€‚çš„é€‰é¡¹å³å¯ã€‚ä¸è®ºåœ¨ Windowsã€Linux è¿˜æ˜¯ Mac æ“ä½œç³»ç»Ÿä¸Šï¼Œå®‰è£…æ­¥éª¤éƒ½æ˜¯å·®ä¸å¤šçš„ã€‚

ä¹Ÿå¯ä»¥é€šè¿‡ä¸åŒç³»ç»Ÿçš„è½¯ä»¶ç®¡ç†å·¥å…·å»å®‰è£…ä½¿ç”¨ï¼š

## Mac

```sh
brew install rustup-init
```

ä¹‹åå¯ä»¥é€šè¿‡ rustup å»æ‰§è¡Œç›¸å…³æ“ä½œã€‚

## Windows

```sh
scoop install rustup-msvc
rustc --version
```

åœ¨ Windows å¹³å°ä¸‹çš„é€‰é¡¹è¦ç¨å¾®éº»çƒ¦ä¸€ç‚¹ã€‚åœ¨ Windows å¹³å°ä¸Šï¼ŒRust æ”¯æŒä¸¤ç§å½¢å¼çš„ ABIï¼ˆApplication Binary Interfaceï¼‰ï¼Œä¸€ç§æ˜¯åŸç”Ÿçš„ MSVC ç‰ˆæœ¬ï¼Œå¦ä¸€ç§æ˜¯ GNU ç‰ˆæœ¬ã€‚å¦‚æœä½ éœ€è¦è·Ÿ MSVC ç”Ÿæˆçš„åº“æ‰“äº¤é“ï¼Œå°±é€‰æ‹© MSVC ç‰ˆæœ¬ï¼›å¦‚æœä½ éœ€è¦è·Ÿ MinGW ç”Ÿæˆçš„åº“æ‰“äº¤é“ï¼Œå°±é€‰æ‹© GNU ç‰ˆæœ¬ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€‰æ‹© MSVC ç‰ˆæœ¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒRust ç¼–è¯‘å™¨è¿˜éœ€è¦ä¾èµ– MSVC æä¾›çš„é“¾æ¥å™¨ï¼Œå› æ­¤è¿˜éœ€è¦ä¸‹è½½ VisualC++ çš„å·¥å…·é“¾ã€‚åˆ° Visual Studio å®˜ç½‘ä¸‹è½½ VS2015 æˆ–è€… VS2017 ç¤¾åŒºç‰ˆï¼Œå®‰è£… C++ å¼€å‘å·¥å…·å³å¯ã€‚

Rustup å®‰è£…ç›¸å…³å·¥å…·åˆ°`~/.cargo`ç›®å½•ä¸‹ï¼ŒåŒæ—¶ä¼šæ›´æ–°æ‚¨çš„ PATH ç¯å¢ƒå˜é‡ä»¥æŒ‡å‘è¯¥ç›®å½•ã€‚åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹å¯ä»¥çœ‹åˆ°ä¸€ç³»åˆ—çš„å¯æ‰§è¡Œç¨‹åºï¼Œæ¯”å¦‚ Rust 1.69 ç‰ˆæœ¬çš„æ—¶å€™ï¼Œåœ¨ Mac å¹³å°ä¸Šå®‰è£…çš„ç¨‹åºå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

```
~/.cargo
â”œâ”€â”€ .package-cache
â”œâ”€â”€ bin
â”‚  â”œâ”€â”€ cargo
â”‚  â”œâ”€â”€ cargo-clippy
â”‚  â”œâ”€â”€ cargo-fmt
â”‚  â”œâ”€â”€ cargo-miri
â”‚  â”œâ”€â”€ clippy-driver
â”‚  â”œâ”€â”€ rls
â”‚  â”œâ”€â”€ rust-gdb
â”‚  â”œâ”€â”€ rust-lldb
â”‚  â”œâ”€â”€ rustc
â”‚  â”œâ”€â”€ rustdoc
â”‚  â”œâ”€â”€ rustfmt
â”‚  â””â”€â”€ rustup
â”œâ”€â”€ env
â””â”€â”€ registry
   â”œâ”€â”€ cache
   â”œâ”€â”€ index
   â””â”€â”€ src
```

è¿™äº›å·¥å…·éƒ½æ˜¯ä¸ Rust ç›¸å…³çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ç”¨é€”ï¼š

| å·¥å…·            | æè¿°                                                                                                                              | é“¾æ¥ ğŸ”—                                                         |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- |
| `cargo`         | Rust çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå®ƒå¯ä»¥å¤„ç†åŒ…ä¾èµ–ã€ç¼–è¯‘å¹¶æ„å»º Rust é¡¹ç›®                                                                         | https://doc.rust-lang.org/cargo/                                |
| `cargo-clippy`  | ä¸€ä¸ª Rust é™æ€åˆ†æå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…æ‰¾å‡ºå¯èƒ½çš„é”™è¯¯å’Œä¸è‰¯ä»£ç é£æ ¼ï¼Œä»¥åŠæä¾›ä¿®å¤å»ºè®®                                              | https://github.com/rust-lang/rust-clippy                        |
| `cargo-fmt`     | ä¸€ä¸ªæ ¼å¼åŒ– Rust ä»£ç çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨é‡æ„ä»£ç çš„ç¼©è¿›ã€ç©ºæ ¼ã€æ¢è¡Œå’Œå…¶ä»–é£æ ¼é—®é¢˜ï¼Œä½¿ä»£ç å˜å¾—æ›´æ˜“äºé˜…è¯»å’Œç»´æŠ¤                  | https://github.com/rust-lang/rustfmt                            |
| `cargo-miri`    | Miri æ˜¯ Rust å®˜æ–¹æä¾›çš„å†…å­˜å®‰å…¨è§£é‡Šå™¨ï¼Œå®ƒå¯ä»¥åœ¨ç¼–è¯‘æ—¶æ£€æµ‹å†…å­˜è¶Šç•Œã€ç©ºæŒ‡é’ˆå¼•ç”¨ç­‰é—®é¢˜ï¼Œå¸®åŠ©å¼€å‘è€…è¯†åˆ«å’Œä¿®å¤ä»£ç ä¸­çš„å†…å­˜å®‰å…¨æ¼æ´     | https://github.com/rust-lang/miri                               |
| `clippy-driver` | ä¸€ä¸ª Rust é™æ€åˆ†æå·¥å…·çš„é©±åŠ¨ç¨‹åºï¼Œå®ƒåŸºäº LLVM çš„ Clang é™æ€åˆ†æå™¨ï¼Œå¹¶æä¾›äº† Rust ç‰¹å®šçš„è¯­è¨€æ”¯æŒï¼Œä»¥æ£€æŸ¥ä»£ç ä¸­çš„æ½œåœ¨é”™è¯¯å’Œä¸è‰¯é£æ ¼ | https://github.com/rust-lang/rust-clippy                        |
| `rls`           | **RLS å·²è¢«å¼ƒç”¨ï¼Œä¸å†å—æ”¯æŒ**ã€‚Rust è¯­è¨€æœåŠ¡å™¨ï¼Œæä¾›äº†è‡ªåŠ¨è¡¥å…¨ã€ä»£ç å¯¼èˆªã€è¯­æ³•æ£€æŸ¥ç­‰åŠŸèƒ½ï¼Œå¸®åŠ©å¼€å‘è€…æ›´é«˜æ•ˆåœ°ç¼–å†™ Rust ä»£ç          | https://github.com/rust-lang/rls                                |
| `rust-gdb`      | GDB çš„ Rust ä¿®æ”¹ç‰ˆï¼Œç”¨äºåœ¨ Rust ä»£ç ä¸­è¿›è¡Œè°ƒè¯•                                                                                    | https://github.com/rust-lang/rust/tree/master/src/etc/rust-gdb  |
| `rust-lldb`     | LLDB çš„ Rust ä¿®æ”¹ç‰ˆï¼Œç”¨äºåœ¨ Rust ä»£ç ä¸­è¿›è¡Œè°ƒè¯•                                                                                   | https://github.com/rust-lang/rust/tree/master/src/etc/rust-lldb |
| `rustc`         | Rust ç¼–è¯‘å™¨ï¼Œç”¨äºå°† Rust ä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œç¨‹åºæˆ–åº“æ–‡ä»¶                                                                             | https://doc.rust-lang.org/rustc/                                |
| `rustdoc`       | Rust æ–‡æ¡£ç”Ÿæˆå™¨ï¼Œç”¨äºåœ¨ Rust ä»£ç ä¸­ç”Ÿæˆ API æ–‡æ¡£å’Œç”¨æˆ·æ‰‹å†Œ                                                                        | https://doc.rust-lang.org/rustdoc/                              |
| `rustfmt`       | ä¸€ä¸ªæ ¼å¼åŒ– Rust ä»£ç çš„åº“å’Œå‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åŒ–é‡æ„ä»£ç çš„ç¼©è¿›ã€ç©ºæ ¼ã€æ¢è¡Œå’Œå…¶ä»–é£æ ¼é—®é¢˜ï¼Œä½¿ä»£ç å˜å¾—æ›´æ˜“äºé˜…è¯»å’Œç»´æŠ¤            | https://github.com/rust-lang/rustfmt                            |
| `rustup`        | ç”¨äºå®‰è£…ã€ç®¡ç† Rust å·¥å…·é“¾å’Œç‰ˆæœ¬çš„å‘½ä»¤è¡Œå·¥å…·                                                                                      | https://rustup.rs/                                              |

åªè¦ç‚¹å‡»ä¸Šè¿°é“¾æ¥ï¼Œä½ å°±å¯ä»¥äº†è§£è¿™äº› Rust å·¥å…·çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

å¯¹ä¹‹åçš„ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ rustup å·¥å…·æ¥ç®¡ç†è¿™äº›å·¥å…·é“¾ï¼š

---

```sh
# æ›´æ–° rustup
rustup self update
# å¸è½½ rust æ‰€æœ‰ç¨‹åº
rustup self uninstall
# æ›´æ–°å·¥å…·é“¾
rustup update
```

---

æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å®ƒè½»æ¾åœ°åœ¨ stable/beta/nightly æ¸ é“ä¸­åˆ‡æ¢ï¼Œæ¯”å¦‚ï¼š

---

```sh
# å®‰è£… nightly ç‰ˆæœ¬çš„ç¼–è¯‘å·¥å…·é“¾
rustup install nightly
# è®¾ç½®é»˜è®¤å·¥å…·é“¾æ˜¯ nightly ç‰ˆæœ¬
rustup default nightly
# æ›´æ–° rustup åˆ°æœ€æ–°
rustup self update
# æ›´æ–° rust ç¼–è¯‘å™¨åˆ°æœ€æ–°çš„ nightly ç‰ˆæœ¬
rustup update nightly
```

---

ä¸ºäº†æé«˜è®¿é—®é€Ÿåº¦ï¼Œä¸­å›½ç§‘æŠ€å¤§å­¦ Linux ç”¨æˆ·åä¼šï¼ˆUSTC LUGï¼‰æä¾›äº†ä¸€ä¸ª[ä»£ç†æœåŠ¡](https://mirrors.ustc.edu.cn/help/rust-static.html)ï¼Œ å»ºè®®å›½å†…ç”¨æˆ·è®¾ç½®å¥½ä»¥ä¸‹ç¯å¢ƒå˜é‡å†ä½¿ç”¨ rustupï¼š

---

```sh
export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static
export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup
```

---

Rust å®˜æ–¹å·¥å…·é“¾è¿˜æä¾›äº†é‡è¦çš„åŒ…ç®¡ç†å·¥å…· [cargo](https://crates.io/)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå·¥å…·è½»æ¾å¯¼å…¥æˆ–è€…å‘å¸ƒå¼€æºåº“ã€‚å¤§å®¶å¯ä»¥ç™»å½•è¿™ä¸ªç½‘ç«™æµè§ˆä¸€ä¸‹ Rust ç¤¾åŒºçƒ­é—¨çš„å¼€æºåº“éƒ½æœ‰å“ªäº›ã€‚å¤§å‹é¡¹ç›®å¾€å¾€éœ€è¦ä¾èµ–è¿™äº›å¼€æºåº“ï¼Œcargo ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ä¸‹è½½ç¼–è¯‘ã€‚åŒæ ·ï¼Œä¸ºäº†è§£å†³ç½‘ç»œé—®é¢˜ï¼Œéœ€è¦åˆ©ç”¨ USTC æä¾›çš„ä»£ç†æœåŠ¡ï¼Œå› ä¸º cargo ç‰ˆæœ¬çš„ä¸åŒï¼Œé…ç½®æ–¹å¼å¯èƒ½ä¹Ÿä¼šæœ‰å·®å¼‚ï¼›

æ¨èå»[ USTC ç½‘ç«™æŸ¥çœ‹](https://mirrors.ustc.edu.cn/help/crates.io-index.html)ç›¸å…³é…ç½®ï¼Œè¿™æ ·ï¼Œåœ¨ç¼–è¯‘éœ€è¦ä¾èµ– crates.io çš„é¡¹ç›®æ—¶ï¼Œä¸ä¼šç”±äºç½‘ç»œé—®é¢˜å¯¼è‡´ä¾èµ–åº“ä¸‹è½½å¤±è´¥ã€‚

## rust-analyzer

mac ä¸Šï¼Œå¦‚æœä¹‹å‰ä½¿ç”¨äº† brew å®‰è£… rust å·¥å…·ï¼›é‚£ä¹ˆ rust-analyzer å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼å®‰è£…ï¼Œä¸»è¦æ˜¯ä¸ºäº†å°†å…¶æ·»åŠ åˆ°ç³»ç»Ÿè·¯å¾„ ï¼š

```sh
rustup component add rust-analyzer
sudo ln -s $(rustup which rust-analyzer ) /usr/local/bin/rust-analyzer
```

[rust-analyzer](https://rust-analyzer.github.io/) é¡¹ç›®å¼€å§‹äº 2017 å¹´å¹´åº•ï¼ˆç¬¬ä¸€æ¬¡æäº¤ï¼‰ã€‚å½“æ—¶ï¼ŒRLS å·²ç»ä¸º Rust æä¾›äº†æ•°å¹´çš„ IDE æ”¯æŒã€‚è™½ç„¶ RLS ç¡®å®èƒ½å¤Ÿå¾ˆå¥½åœ°å¤„ç†ä¸€äº›é‡è¦åŠŸèƒ½ï¼Œä½†å®ƒä¸ IDE å‘å…¶ä»–ä¸€äº›è¯­è¨€æ‰€æä¾›çš„åŠŸèƒ½ä¸°å¯Œç¨‹åº¦å’Œä½“éªŒä¸Šè¿˜æœ‰è¾ƒå¤§å·®è·ã€‚

::: warning

> â—ï¼šRLS å·²è¢«å¼ƒç”¨ï¼Œä¸å†å—æ”¯æŒã€‚è¢« rust-analyzer å–ä»£ã€‚å®˜æ–¹é¼“åŠ±ç”¨æˆ·å¸è½½ RLS å¹¶æŒ‰ç…§ rust-analyzer æ‰‹å†Œä¸­çš„è¯´æ˜ä¸ºæ‚¨çš„ç¼–è¾‘å™¨å®‰è£…å®ƒã€‚
> :::

æœ€åˆï¼Œrust-analyzer åªæ˜¯ä¸ºäº† Rust çš„å®¹é”™è§£æã€‚åæ¥ rust-analyzer çš„åŠŸèƒ½è¶Šæ¥è¶Šå¼ºå¤§ï¼Œå¦‚ä»Šå·²ç»æˆä¸º Rust ç¼–ç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€ä¸ªåˆ©å™¨äº†ã€‚ä½† rust-analyzer æ­¤å‰å¹¶ä¸æ˜¯ä¸€ä¸ªå®˜æ–¹çš„ Rust é¡¹ç›®ï¼Œè¿™ä¸ºå°† rust-analyzer è¿‡æ¸¡ä¸ºå®˜æ–¹ LSP å®ç°å¢åŠ äº†éš¾åº¦ã€‚

rust-analyzer æ˜¯ Rust ç¼–ç¨‹è¯­è¨€çš„[è¯­è¨€æœåŠ¡å™¨åè®® (LSP) ](https://microsoft.github.io/language-server-protocol/)çš„å®ç°ã€‚å®ƒä¸ºè®¸å¤šä»£ç ç¼–è¾‘å™¨ï¼ˆåŒ…æ‹¬ VS Codeã€Emacs å’Œ Vimï¼‰æä¾›å®Œæˆå’Œè½¬åˆ°å®šä¹‰ç­‰åŠŸèƒ½ã€‚

VS Code æ˜¯ç›®å‰å¯¹ rust-analyzer æ”¯æŒæœ€å¥½çš„ç¼–è¾‘å™¨ã€‚

> å®˜æ–¹ï¼šThis is the best supported editor at the moment. The rust-analyzer plugin for VS Code is maintained in tree.

æœ‰äº†è¿™äº›å‡†å¤‡ï¼Œå¤§å®¶å°±å¯ä»¥åœ¨ Visual Studio Code ä¸­ä¸‹è½½æ”¯æŒ Rust çš„æ’ä»¶ï¼Œæå‡ç¼–è¾‘ä½“éªŒã€‚ç†è®ºä¸Šæ¥è¯´ï¼ŒRLS å¯ä»¥è·Ÿä»»ä½•ç¼–è¾‘å™¨æˆ–è€…é›†æˆå¼€å‘ç¯å¢ƒé…åˆä½¿ç”¨ï¼Œåªè¦è¿™ä¸ªç¼–è¾‘å™¨å®ç°äº†å®ƒä»¬ä¹‹é—´çš„é€šä¿¡åè®®å³å¯ã€‚

æœ‰äº†ä¸Šé¢è¿™äº›å‡†å¤‡å·¥ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼å¼€å§‹ Rust ç¼–ç¨‹ä¹‹æ—…äº†ã€‚é¦–å…ˆï¼Œæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼Œçœ‹çœ‹ rustc ç¼–è¯‘å™¨èƒ½å¦æ­£å¸¸è¿è¡Œï¼Œä½¿ç”¨`-V`å‘½ä»¤æŸ¥çœ‹ rustc çš„ç‰ˆæœ¬ï¼š

---

```sh
$ rustc -V
rustc 1.20.0-nightly (f85579d4a 2017-07-12)
```

---

å¦‚æœçœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºï¼Œè¯´æ˜ç¼–è¯‘å™¨å·²ç»å¯ä»¥æ­£å¸¸å·¥ä½œã€‚æ¥ä¸‹æ¥ï¼Œè¯·å¤§å®¶æ¢ç´¢ä¸€ä¸‹è¿™äº›å·¥å…·çš„ç®€æ˜ä½¿ç”¨å¸®åŠ©ï¼š

1ï¼‰ä½¿ç”¨`rustc -h`å‘½ä»¤æŸ¥çœ‹ rustc çš„åŸºæœ¬ç”¨æ³•ï¼›

2ï¼‰ä½¿ç”¨`cargo -h`å‘½ä»¤æŸ¥çœ‹ cargo çš„åŸºæœ¬ç”¨æ³•ï¼›

3ï¼‰ä½¿ç”¨`rustc -C help`å‘½ä»¤æŸ¥çœ‹ rustc çš„ä¸€äº›è·Ÿä»£ç ç”Ÿæˆç›¸å…³çš„é€‰é¡¹ï¼›

4ï¼‰ä½¿ç”¨`rustc -W help`å‘½ä»¤æŸ¥çœ‹ rustc çš„ä¸€äº›è·Ÿä»£ç è­¦å‘Šç›¸å…³çš„é€‰é¡¹ï¼›

5ï¼‰ä½¿ç”¨`rustc -Z help`å‘½ä»¤æŸ¥çœ‹ rustc çš„ä¸€äº›è·Ÿç¼–è¯‘å™¨å†…éƒ¨å®ç°ç›¸å…³çš„é€‰é¡¹ï¼›

::: warning
â—ï¼šthe option `Z` is only accepted on the nightly compiler
:::

6ï¼‰ä½¿ç”¨`rustc --help -v`å‘½ä»¤æŸ¥çœ‹ rustc çš„æ›´è¯¦ç»†çš„é€‰é¡¹è¯´æ˜ã€‚

> [ç¬¬ä¸‰æ–¹ cargo å­å‘½ä»¤](https://github.com/rust-lang/cargo/wiki/Third-party-cargo-subcommands)
